var superagent = require("superagent"),
    utils = require("./utils");

module.exports = utils.extend({},superagent,{
  action:function(actionName) {
    var request = superagent(),
        currentURL = utils.currentURL(),
        data = {
          _ombl_is_ajax:"yes",
          _action:actionName
        };
    
    var token = window.document.body.getAttribute("data-t");

    if(token) {data.ombl_t = token}

    // redirect_base = aek.request("_ombl_redirect_base")
    
    // if redirect_base
    //   ajaxOptions.data._ombl_redirect_base = redirect_base 
    
    // #must remove any redirect urls
    // ajaxOptions.url = ajaxOptions.url.replace(/\/r\/\d+/,"")

    return superagent.post(currentURL)
      .type('form')
      .send(data)
  }
})